# Prediction model using Geometric Brownian Motion (GBM) part 1

This model is one of the most widely used methods in prediction of stock prices. Basically, GBM is an exponential model that rises over time, but which also will include a randomness in its behaviour.

Even though, one should never use the past data to predict prices, I will try to such problems with most of the tools available to come up with a solution of the problem assessed.

## Cost models

In order to predict and give a recommendation to the client about how much should they increase their costs in order to survive a cost model should be done first.

In the development of this is easier if one could retrieve al the neccesary information and try to include, as much as possible cost and prices information.

A matrix of indexes is needed, in this matrix (M) I included the amount of weigth of material, man work indexes, human-work cost index, infrastructure costs index needed to produce the client's products. 

A matrix of costs (C) will include a unit price whose multiplication with M (M x C), gives as a result monetary unit. For example, this unit price can be expressed in $ / kg, $ / rolls, $ / tons, $ / parcel, $ / hours, $ / hour, $ / sales, precentage, etc. Every item included in the unit and matrix index will be like us, unique and unrepeatable, but both will have to match that the estimated costs (E) will results in moneatry value.

For us to establish a complete retail price, depending on the country, one must include taxes and then add the profit. In this example, the estimated costs will be increased by 16 percent, and after that, an additional 20 percent will be added to cover the profit.



```python
import pandas as pd
import numpy as np

mat1 = pd.read_excel('Matrices de costos.xlsx','Matriz Julio (2)',usecols="B:F")#in this matrix I included an analysis of all the costs of the clients products
precios1 = pd.read_excel('Matrices de costos.xlsx','Matriz Julio (2)',usecols="h:l")#prices of the goods necesary to calculate the costs of the prices
inf1 = pd.read_excel('Matrices de costos.xlsx','Matriz Julio (2)',usecols="h")#taxes and profit precentages
act1 = pd.read_excel('Matrices de costos.xlsx','Matriz Julio (2)',usecols="h")#retail price

indicadores = mat1[14:24]#cost matrix (M)
precios = precios1[14:15]#goods costs (C)
utilidad = inf1[17:19]#
actuales = act1[27:37] 

pre = (np.array(precios.values)[0]).astype(np.float32)#C[0]Price of good1,C[1]Price of good2,[2]Price of scrap steel,[3]Cost of work per piece,[4]Cost of infrastructure per piece
ind = (np.array(1/indicadores.values)).astype(np.float32)#indexes of the costs to each product
uti = ((np.array(utilidad.values)).astype(np.float32)).reshape(1,2)[0]#taxes and profit percentage
act = np.array(actuales.values).astype(np.float32).reshape(1,10)[0]#retail price
pro = np.array(['Estrella','Cometa','Galaxia','Planeta','Meteorito','Asteroide','Bolido','Nebulosa','Luna','Blazar'])#product names

factor = uti[0]*m_uti[1]#taxes and profit in one number


```

## Scenarios Analysis

In a further analysis, we observe that the price of one of the goods has raised considerably. Due to practicalities, we decided to keep the rest of the costs fixed and analyse a number scenarios where this item keeps increasing over time.


```python
import matplotlib.pyplot as plt


def analisis_1(ind,pre,acero,act,sce,pro):
    pre_1[2] = acero
    costest = np.dot(ind,pre)
    costest_0 = 1.16*costest
    prest_0 = 1.2*costest_0
    costest_0,prest_0,act
    
    #graph1
    
    num = np.arange(10)
    anc = 0.2

    plt.bar(num,prest_0,anc,label='Sugested price (16% tax and 20% profit)')
    plt.bar(num+anc,costest_0,anc,label='Real costs (16% tax)')
    plt.bar(num+2*anc,act,anc,label='Retail Price')
    plt.ylabel('Monetary unit')
    plt.xlabel('Products')
    plt.xticks(num + 0.5 /3 ,pro)
    plt.xticks(rotation=45)
    plt.title('Cost analysis 1. '+sce)
    plt.legend(loc='best')
    plt.grid(b=True, which='major', axis = 'y' , color='#A79E9E', linestyle='-', linewidth=0.4)
    plt.minorticks_on()
    plt.grid(b=True, which='minor', axis = 'y' , color='#999999', linestyle='-', alpha=0.2)
    plt.show()
    
    #graph2
    plt.bar(num,(act-costest_0), label='Retail prices - Real costs (16% tax)')
    plt.ylabel('Monetary unit')
    plt.xlabel('Products')
    plt.xticks(num+0.35 / 2,pro)
    plt.xticks(rotation=45)
    plt.title('Cost analysis 2. '+sce)
    plt.legend(loc='best')
    plt.grid(b=True, which='major', axis = 'y' , color='#A79E9E', linestyle='-', linewidth=0.4)
    plt.minorticks_on()
    plt.grid(b=True, which='minor', axis = 'y' , color='#999999', linestyle='-', alpha=0.2)
    plt.show()
    
```


### Scenario 0

Initial conditions, the cost of today material for this is 1657.6. In this way, the conditions at the moment of the study can be analysed.

The analysis allows us to observe the cange of the prices of each product.

#### Graph 1. Cost Analysis 1.

For the actual analysis we observe three different bars, each one of them shows a suggested price, based on the Real Costs (16%) and the retail price. 

#### Graph 2. Cost Analysis 2.

We can see the result of the Retail Price - Real Costs, thus getting the profit units in each of the clients products.




```python
analisis_1(ind,pre,1657.6,act,'Scenario 0',pro)
```


![](https://github.com/highjoule/prices_prediction/blob/main/images/scen0_1.png)



![](https://github.com/highjoule/prices_prediction/blob/main/images/scen0_2.png)


### Scenario 1

A unit price of 1800 is observed in this Scenario. Nine of the ten client's products have a positive profit in this case.


```python
analisis_1(ind,pre,1800,act,'Scenario 1',pro)
```


![](https://github.com/highjoule/prices_prediction/blob/main/images/scen1_1.png)



![](https://github.com/highjoule/prices_prediction/blob/main/images/scen1_2.png)

### Scenario 2

A price of 2000 has a positive profit per unit.


```python
analisis_1(ind,pre,2000,act,'Scenario 2',pro)
```


![](https://github.com/highjoule/prices_prediction/blob/main/images/scen2_1.png)



![](https://github.com/highjoule/prices_prediction/blob/main/images/scen2_2.png)


### Scenario 3

With a price of 2400, 5 products of the 10 products represent losses to the client.


```python
analisis_1(ind,pre,2400,act,'Scenario 3',pro)
```


![](https://github.com/highjoule/prices_prediction/blob/main/images/scen3_1.png)



![](https://github.com/highjoule/prices_prediction/blob/main/images/scen3_2.png)


## Conclusion

A price of 2400 to this item would represent loss to the client. In the next part, I will demonstrate how to predict the price of this good in the coming months using Geometric Brownian Motion model.

Then, after such prediction a recomendation of price adjustment can be done.


```python

```


```python

```


```python

```


```python

```


```python

```


```python

```


```python

```


```python

```


```python

```


```python

```


```python

```


```python

```


```python

```


```python

```


```python

```


```python

```


```python

```


```python
data = pd.read_excel("COSTOS.xlsx",'BASE2',usecols='A:G')
new = pd.read_excel("COSTOS.xlsx",'BASE2_NEW',usecols='A:G')

```


```python
data
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>FECHA</th>
      <th>ULT</th>
      <th>APT</th>
      <th>MAX</th>
      <th>MIN</th>
      <th>VOL</th>
      <th>VAR</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2015-11-24</td>
      <td>195.00</td>
      <td>195.00</td>
      <td>195.00</td>
      <td>195.00</td>
      <td>-</td>
      <td>0.0000</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2015-11-25</td>
      <td>195.00</td>
      <td>195.00</td>
      <td>195.00</td>
      <td>195.00</td>
      <td>-</td>
      <td>0.0000</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2015-11-26</td>
      <td>192.00</td>
      <td>192.00</td>
      <td>192.00</td>
      <td>192.00</td>
      <td>-</td>
      <td>-0.0154</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2015-11-27</td>
      <td>192.00</td>
      <td>192.00</td>
      <td>192.00</td>
      <td>192.00</td>
      <td>-</td>
      <td>0.0000</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2015-11-28</td>
      <td>195.52</td>
      <td>195.52</td>
      <td>195.52</td>
      <td>195.52</td>
      <td>-</td>
      <td>0.0183</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>1313</th>
      <td>2021-02-04</td>
      <td>415.00</td>
      <td>415.00</td>
      <td>415.00</td>
      <td>415.00</td>
      <td>0.06K</td>
      <td>0.0234</td>
    </tr>
    <tr>
      <th>1314</th>
      <td>2021-02-05</td>
      <td>408.00</td>
      <td>408.00</td>
      <td>408.00</td>
      <td>408.00</td>
      <td>0.12K</td>
      <td>-0.0169</td>
    </tr>
    <tr>
      <th>1315</th>
      <td>2021-02-06</td>
      <td>415.00</td>
      <td>415.00</td>
      <td>415.00</td>
      <td>415.00</td>
      <td>0.04K</td>
      <td>0.0172</td>
    </tr>
    <tr>
      <th>1316</th>
      <td>2021-02-09</td>
      <td>417.00</td>
      <td>417.00</td>
      <td>417.00</td>
      <td>417.00</td>
      <td>0.09K</td>
      <td>0.0048</td>
    </tr>
    <tr>
      <th>1317</th>
      <td>2021-02-10</td>
      <td>418.00</td>
      <td>418.00</td>
      <td>418.00</td>
      <td>418.00</td>
      <td>-</td>
      <td>0.0024</td>
    </tr>
  </tbody>
</table>
<p>1318 rows Ã— 7 columns</p>
</div>




```python
import numpy as np
so = np.array(data['ULT'].values)[-1]
so
```




    418.0




```python
dt = 1
T = 365
N = T/dt
t = np.arange(1, int(N)+1)
```


```python
t
```




    array([  1,   2,   3,   4,   5,   6,   7,   8,   9,  10,  11,  12,  13,
            14,  15,  16,  17,  18,  19,  20,  21,  22,  23,  24,  25,  26,
            27,  28,  29,  30,  31,  32,  33,  34,  35,  36,  37,  38,  39,
            40,  41,  42,  43,  44,  45,  46,  47,  48,  49,  50,  51,  52,
            53,  54,  55,  56,  57,  58,  59,  60,  61,  62,  63,  64,  65,
            66,  67,  68,  69,  70,  71,  72,  73,  74,  75,  76,  77,  78,
            79,  80,  81,  82,  83,  84,  85,  86,  87,  88,  89,  90,  91,
            92,  93,  94,  95,  96,  97,  98,  99, 100, 101, 102, 103, 104,
           105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117,
           118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130,
           131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143,
           144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156,
           157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169,
           170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182,
           183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195,
           196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 208,
           209, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 220, 221,
           222, 223, 224, 225, 226, 227, 228, 229, 230, 231, 232, 233, 234,
           235, 236, 237, 238, 239, 240, 241, 242, 243, 244, 245, 246, 247,
           248, 249, 250, 251, 252, 253, 254, 255, 256, 257, 258, 259, 260,
           261, 262, 263, 264, 265, 266, 267, 268, 269, 270, 271, 272, 273,
           274, 275, 276, 277, 278, 279, 280, 281, 282, 283, 284, 285, 286,
           287, 288, 289, 290, 291, 292, 293, 294, 295, 296, 297, 298, 299,
           300, 301, 302, 303, 304, 305, 306, 307, 308, 309, 310, 311, 312,
           313, 314, 315, 316, 317, 318, 319, 320, 321, 322, 323, 324, 325,
           326, 327, 328, 329, 330, 331, 332, 333, 334, 335, 336, 337, 338,
           339, 340, 341, 342, 343, 344, 345, 346, 347, 348, 349, 350, 351,
           352, 353, 354, 355, 356, 357, 358, 359, 360, 361, 362, 363, 364,
           365])




```python
ret = np.array(data['ULT'].values)
```


```python
mu = data['VAR'].mean()
mu
```




    0.0007558421851289834




```python
sigma = np.std(data['VAR'])
sigma
```




    0.018793117545602527




```python
esc = 3
b = {str(scen): np.random.normal(0, 1, int(N)) for scen in range(1, esc + 1)}
```


```python
b
```




    {'1': array([-7.88725592e-01, -1.45834306e+00, -1.09063476e+00, -5.51304638e-01,
            -3.99943841e-01,  5.49652186e-01,  5.91593062e-01,  1.18347813e-01,
             8.50589513e-02,  2.75975029e-01,  1.11475465e-01, -1.46382918e+00,
            -2.02514333e+00,  1.80162121e+00,  8.15727332e-01, -2.66513586e-01,
             1.82578902e-01, -1.72975874e+00, -3.46821814e-01, -4.58732594e-02,
            -1.54261421e+00, -1.76384293e+00, -3.47172948e-01,  3.65486112e-01,
             9.13821735e-01,  8.99468352e-01, -4.84120862e-01, -1.10905434e-01,
            -1.06009256e+00, -4.68750457e-01, -8.96652010e-01,  1.06444421e+00,
            -5.79845839e-01, -3.01732284e-01, -9.09981908e-01,  1.47338947e+00,
             5.36321030e-01, -1.20018446e+00,  5.65535743e-01,  9.76051338e-01,
             1.33269533e+00,  4.53596508e-02, -3.64870436e-01, -1.34618187e-01,
             1.10485170e+00,  8.95218974e-01, -9.84251146e-01, -2.69427007e-02,
             2.03932186e+00,  1.33091687e+00, -6.29802060e-01, -1.12359717e-01,
             2.54483791e-01, -1.57515798e-01,  5.64608605e-01,  1.03527523e+00,
            -8.79725953e-01,  1.87591281e-01, -1.61838165e+00, -1.43512379e+00,
            -1.10942596e+00,  8.72412655e-02,  2.68708062e-01,  7.19609803e-01,
             7.86094818e-01,  5.04630150e-01,  4.37219650e-01, -9.86840403e-02,
             1.06575375e+00,  8.01608215e-01, -1.06306488e+00, -1.05314023e+00,
            -2.76132863e-01, -5.85744601e-02,  2.52024275e-01, -2.57630731e+00,
             3.27897784e-01, -4.59656992e-01, -8.16634119e-01,  3.87923296e-01,
             9.66276749e-01, -4.93004798e-01,  2.24156875e-01, -4.29403761e-01,
             1.09608568e+00, -2.17783519e-01, -5.55247053e-01, -1.29544606e-01,
             1.69263890e-01,  6.04694439e-01, -2.32937086e+00, -3.47640180e-01,
             1.53943460e+00,  6.08851487e-01, -1.82742991e-01,  1.14184412e+00,
            -9.34289247e-01,  7.12610714e-01,  1.15677246e+00,  1.86185946e+00,
            -2.34966821e-01, -4.16804436e-01,  1.10779885e+00, -4.61823943e-01,
             6.88167243e-01, -3.94910449e-01, -9.51022959e-01, -5.05307850e-01,
            -6.76105457e-01,  8.85469225e-01, -5.73777534e-01,  1.82921478e+00,
            -2.17980780e-01,  7.81452869e-01,  4.33473953e-01, -6.50880111e-01,
             1.42986261e-02, -2.40585509e+00,  9.01225936e-01,  1.76387142e+00,
            -6.02737424e-02, -1.39966444e+00,  4.87172892e-01,  1.67151508e+00,
            -1.74259764e+00,  1.61019803e+00,  1.70053907e-01, -1.31300000e+00,
             4.21700256e-01,  3.21992136e+00,  1.77697217e+00,  8.00130523e-01,
             1.13131119e+00, -5.69891642e-02, -3.45092534e-01,  6.46972528e-02,
             2.21015619e-02, -1.91160848e+00, -3.74846973e-01,  1.65092144e-01,
            -9.97177145e-01,  1.61000508e-01,  1.46951072e+00,  3.74178923e-01,
             7.65787168e-02, -1.72776361e+00, -1.52401389e+00,  7.00905641e-01,
            -5.40362608e-01, -1.27659478e+00,  6.42475851e-01, -7.98709469e-03,
            -1.70151204e-01, -1.81735872e+00,  7.47492704e-01, -7.76939933e-02,
             5.54118696e-01,  1.66629647e+00, -2.82491262e-01, -7.45524961e-01,
             6.66486471e-01, -5.87773875e-01,  3.47616609e-01, -1.41647400e+00,
            -7.66387610e-01,  4.77373418e-01,  1.73696519e-01,  8.71733407e-01,
            -9.18899589e-01, -4.33778708e-01,  2.53363285e-01, -1.40524521e+00,
             1.31896969e+00,  2.10345550e-01, -1.18465355e+00, -1.85470175e-01,
             1.11902444e+00,  2.05464161e-01, -1.59664095e+00, -9.68121716e-01,
             6.19672016e-01, -7.01760230e-01, -5.88381083e-01,  1.28115023e+00,
             8.76380658e-01,  4.15481882e-01,  1.01992580e+00,  9.96570708e-02,
            -5.07675932e-01, -3.18131827e-01,  1.21901957e+00, -5.31193365e-02,
             1.20949762e+00,  1.17642794e+00,  2.07264935e+00, -1.60546029e+00,
            -1.52328592e+00,  1.02352953e-03, -5.28308487e-01, -2.04983695e-01,
            -7.07068143e-01, -2.17768171e+00,  3.78021368e-01,  2.20424516e+00,
            -1.06512513e-01,  9.84631440e-01,  1.32598521e+00, -4.40000906e-01,
            -1.14556793e+00, -1.33169406e+00, -8.53643047e-02,  5.52671954e-01,
            -3.89343554e-01,  1.13322158e-01, -9.85532550e-01, -1.46970260e-01,
             6.04912931e-01, -6.14974427e-01, -5.19279364e-01, -7.39199453e-01,
            -6.09002967e-01,  5.94639687e-01,  8.54570194e-01, -9.67202211e-01,
            -7.00035227e-01,  4.48734463e-01,  4.73588293e-01,  1.02948507e+00,
            -5.22806388e-01,  1.00312594e+00,  1.79522281e-01, -2.37097578e-01,
            -1.54641906e-01,  1.49466669e+00,  1.12781165e-02,  7.98035979e-01,
             6.22143304e-01, -6.37528722e-02, -1.44122761e+00,  5.18697923e-01,
             1.51363906e+00, -6.98443222e-01,  7.19577480e-01,  2.88556312e+00,
             1.52133553e+00, -1.56662043e-01,  1.09725827e+00,  1.53354018e-01,
            -3.13031011e-01,  1.39851750e+00, -7.17527475e-01,  9.74682093e-01,
             6.43459506e-01, -1.02706712e+00, -1.25547266e-02,  7.73000886e-01,
             1.33811482e-01, -7.62683131e-02,  4.41992954e-01, -8.44091215e-01,
            -3.30402067e-01,  1.50228330e-01,  1.00531006e+00, -6.39499762e-01,
            -4.20063969e-01,  9.59545895e-01, -1.61650561e-01, -2.58168660e-01,
             5.01404167e-01,  1.47449488e+00,  6.02073035e-01,  1.14744791e-01,
            -1.70175254e-01, -2.22219731e+00, -2.91003638e-02, -1.76427932e+00,
            -9.09403777e-01, -6.05097528e-01,  3.13154733e-01, -7.47158684e-02,
            -1.41071283e+00,  4.07797796e-01, -2.99607473e-01, -2.37377418e-01,
             1.73835000e+00,  2.06349536e+00, -1.06721294e+00, -1.02548226e+00,
            -7.32077927e-01, -7.47231605e-01, -1.71242423e+00, -1.70376732e+00,
            -6.61669583e-01,  3.21327320e-01,  7.87436822e-01, -6.37684453e-01,
            -3.36456354e-01,  6.69434661e-02,  7.86493055e-01, -7.11985941e-01,
             2.09734685e-01,  7.02838389e-01, -4.12825481e-01,  1.42210287e+00,
             5.33419469e-01,  8.81945377e-01, -9.73514015e-01, -1.54799409e+00,
             1.08843016e+00, -9.86217837e-01, -1.19914245e+00, -1.26698470e+00,
            -7.53585964e-01,  2.42395021e-01, -1.61902605e-01,  3.49164421e-01,
            -2.09815185e-01,  8.38104889e-01, -1.90386548e-01, -2.65716337e-01,
            -8.10174349e-01,  9.77416057e-01, -4.26429811e-02,  3.79208989e-01,
            -1.87851632e+00, -9.70285469e-01,  7.51200218e-01,  1.33170504e+00,
            -2.97104761e-01,  1.59736474e+00,  1.26616204e+00, -4.40955767e-01,
            -7.48173040e-01,  4.51844580e-02, -1.50661468e-01,  5.10262383e-01,
             8.94550458e-01, -5.68623668e-02,  6.66978730e-01,  1.19964049e+00,
             2.94967846e-01,  8.12825540e-01,  1.41207728e-01,  5.27673038e-01,
             1.60708933e-01,  1.63274855e+00,  3.56299375e-01, -4.31756017e-01,
             3.24137174e-01, -1.62619437e+00, -1.14887003e+00,  7.77775473e-01,
            -9.17260633e-01, -8.28384705e-01, -4.02644800e-01, -4.40235872e-01,
             8.72548703e-01, -3.09522970e-01, -1.13327997e+00, -1.44273536e+00,
             1.62160989e+00, -2.55690633e+00, -6.14275981e-01, -6.10754032e-01,
             4.97571837e-01]),
     '2': array([ 5.07198877e-01, -1.52166087e+00,  3.55793889e-01, -1.14076339e-01,
             3.06086430e-01,  7.50454088e-01,  1.08458286e+00,  1.90688030e-03,
            -4.97757743e-01,  1.25038620e+00, -8.56684206e-01, -5.39983000e-02,
            -1.45448858e+00, -1.49026522e+00, -6.21402008e-01, -3.60896833e-01,
            -1.93310710e+00,  5.47886030e-01,  1.08736978e+00, -9.45289383e-01,
             6.63581203e-01,  1.55154866e+00, -6.83265767e-01, -3.40799344e-01,
            -5.94840894e-01,  5.86732452e-01,  7.54972857e-01, -1.76906423e+00,
             2.03527151e+00, -1.11455150e+00, -2.43330396e-01, -2.17552390e+00,
            -1.93358215e+00,  4.19980781e-01,  9.24893045e-01, -1.13040514e+00,
            -7.16524151e-01,  6.77536006e-01,  1.22058549e+00, -6.02743690e-01,
             5.60731689e-01,  8.06459940e-02, -1.97343299e-01,  1.09934652e+00,
            -2.50638583e-01,  4.16925001e-01,  3.95406497e-01, -2.18496615e-01,
            -2.59565115e-01,  7.57677868e-01, -3.23637115e-01, -7.49542695e-01,
             1.76104499e+00,  3.38984150e-01, -1.09122202e+00,  1.13073695e+00,
             1.53372137e-01,  1.68714385e+00, -1.45381972e+00, -1.09794410e+00,
            -9.04096276e-01,  2.69441514e-01,  7.41520755e-01,  8.17103773e-01,
            -2.86127364e-02,  4.57735614e-01, -6.34219900e-01,  1.96276521e-01,
            -6.47482412e-01, -2.92610030e+00, -4.54766225e-01, -2.03903644e-01,
            -1.21749396e-01,  1.15839940e+00, -4.59547780e-01,  5.09355346e-01,
            -5.95883970e-02, -2.41203793e+00,  3.32547726e-01,  2.31860995e+00,
            -1.00594395e+00,  4.43248705e-01,  6.51051745e-01, -4.03003896e-01,
            -1.25566050e+00,  2.85190302e-01, -8.56743084e-01, -5.85350311e-01,
            -7.83627864e-01, -8.92045246e-02, -9.09387649e-02,  8.34544822e-01,
            -1.61381537e+00,  1.69340680e-01, -2.93516326e-01,  7.23388926e-01,
             8.85292775e-02, -1.27430875e+00,  3.86389477e-01, -8.24444633e-01,
             5.25042867e-01,  4.12401845e-01,  2.95598407e-01,  1.09961589e+00,
            -2.03827329e-01, -2.58243077e-01,  3.26524585e-01, -2.13749355e+00,
             1.61711547e+00, -3.08307981e-01, -2.31352930e+00, -4.53988219e-01,
            -4.20806491e-02, -1.11737747e+00, -1.25384605e+00,  3.77101959e-01,
            -1.34208314e+00, -2.92811554e-01,  3.30979504e-01,  1.28044846e+00,
            -2.94059406e-02, -1.08874917e-01, -5.23414593e-01, -1.53859084e+00,
            -1.25705795e+00,  1.07878354e+00, -5.62441367e-02, -8.19278858e-01,
             3.40856328e-02, -7.57669059e-01,  2.60937189e-01, -2.72530217e-03,
             7.48900084e-01, -4.97524258e-01,  4.04556547e-01, -1.35544075e-02,
            -5.43631346e-01, -4.40030085e-01, -1.60779345e+00,  3.21000705e-01,
             8.12744680e-02, -1.26073228e+00, -2.19881145e+00, -2.27285999e-02,
            -1.54429143e+00,  3.48958568e-01,  4.14338462e-01,  1.46203289e+00,
            -1.86049423e-01, -8.25385377e-01,  1.12178929e+00, -8.86050903e-01,
            -6.92337472e-01, -1.16464571e+00, -7.04829533e-01,  2.65858960e-01,
            -6.71732702e-01,  1.06324785e+00, -7.78722431e-01, -2.11985593e-01,
            -5.70161313e-01,  1.36150582e+00, -1.10758043e+00,  1.86145736e+00,
            -7.23232138e-01,  5.04836260e-01,  3.57840448e-01, -2.43506269e-01,
             9.80078265e-01,  1.03398423e+00,  1.19275957e+00, -6.35546400e-01,
             1.43875601e+00,  1.97607645e+00,  1.05414278e+00,  1.14015823e+00,
            -4.84654314e-01,  8.69937093e-01, -1.78845229e-01,  1.93585641e+00,
             9.37337644e-01,  4.66329719e-01,  5.94646646e-01, -2.74399607e-01,
             1.06249662e+00, -1.79391267e+00,  8.52673282e-02, -1.76970278e-01,
             8.83263720e-01, -1.79683349e+00, -9.72034693e-01, -1.91311463e+00,
             5.39221077e-01, -1.08838851e+00, -1.03084311e+00,  2.08149009e+00,
             4.20149879e-01,  5.45622189e-01,  2.14006134e+00, -8.16624291e-01,
             1.81109845e-01,  2.37177995e-01, -1.00649033e+00,  1.08350991e+00,
            -7.41751884e-01, -7.08432677e-01, -8.99182194e-01,  1.31443837e-01,
            -1.75016665e+00, -3.30863002e-01,  8.45062061e-01,  2.23247995e-01,
             2.25273543e+00,  3.43244074e-01, -3.50239502e-01, -5.45480371e-01,
             9.51493383e-01,  5.13604875e-01,  2.43812823e-01,  3.51543192e-01,
            -2.38189279e-01,  1.22047769e-02, -4.44933439e-01, -1.99785828e+00,
            -8.69161344e-01,  3.66352999e-01,  1.72530220e+00,  3.14626996e-01,
            -2.11791504e-01, -1.51091940e+00, -2.29633700e-01, -1.06415587e-01,
             3.51671667e-02, -1.29595020e+00,  4.37180691e-01, -1.10832452e+00,
            -4.89501862e-01,  6.20450175e-01, -1.15257549e+00, -4.92443916e-01,
            -9.15932439e-01,  1.60948330e-01, -6.17313849e-01, -5.76652970e-01,
            -1.87515000e-01, -3.17613037e-01,  1.89278823e+00,  3.78658594e-01,
             2.91598710e+00, -1.64161175e+00, -2.56364129e-01, -6.38951449e-02,
            -6.43685466e-01, -1.82386645e-03, -3.16874532e-01, -7.71477289e-01,
            -8.92699100e-01,  4.82834484e-01, -3.48756487e-01, -1.33991953e-01,
            -1.82564007e+00, -1.11152926e+00, -2.94738663e-01,  5.95309780e-01,
             9.05694160e-01, -3.04797315e-01,  1.30199560e-01,  6.85180495e-01,
             1.20061907e+00,  4.77052618e-01, -6.58235692e-01, -1.03316823e-01,
            -1.04124505e+00,  6.11168753e-01,  2.76397296e-01, -1.30441534e+00,
             7.33457295e-01,  3.46720950e-01,  7.80880274e-01,  4.83588246e-01,
             9.29089409e-01,  2.99432094e-01, -6.76280107e-02,  3.85053082e-01,
             3.19677108e-01, -9.64926587e-01, -5.81171124e-01, -1.65378872e+00,
            -6.58018379e-01,  1.25633549e-01, -3.23205413e-01,  5.69032325e-01,
            -9.55403949e-01,  1.70962176e+00, -5.49171939e-01,  1.27406126e+00,
            -1.39979319e-01,  6.78482209e-01, -7.78923005e-02,  1.01627641e-01,
            -4.15805504e-01, -7.90953698e-01,  1.49887521e-01,  3.09090914e-01,
             4.14943442e-01,  1.13453491e+00, -1.57912175e+00,  1.02593635e+00,
             7.54303116e-01, -3.70377338e-01,  3.44274635e-01, -5.65552154e-01,
            -1.39776342e+00, -6.20696950e-02, -5.16385959e-01,  1.12327804e-01,
             4.46615836e-01, -1.24649461e+00, -1.06320972e+00,  6.79426939e-01,
            -1.31228407e-01, -3.09584247e-01,  1.09025917e+00,  6.65453700e-01,
             3.32488288e-01,  8.83469373e-01,  5.00808164e-01, -2.79360921e-02,
             1.14924207e+00, -2.18330689e-02,  1.11967527e-01, -1.81431032e+00,
             8.49602235e-01, -1.45878652e+00,  6.38644426e-01,  8.24047330e-02,
            -2.08525455e+00,  7.43586073e-01, -2.39227667e+00,  8.47622363e-01,
            -4.03846262e-01, -1.57077554e-01,  1.07632049e-01,  9.43141919e-02,
             1.24028730e-01,  3.38606702e-01, -1.61390863e-03, -9.47787115e-01,
            -1.37649393e+00,  9.29165837e-01,  1.20347970e+00, -1.37181938e-01,
             2.36638588e-01, -1.72272703e+00, -7.54835191e-01, -1.03679775e+00,
             1.25061387e+00, -1.20795126e+00, -1.08572888e+00, -1.85647074e+00,
             2.14213252e-01,  7.03462975e-02,  6.98535407e-01,  1.43595741e-01,
             1.21893402e-01]),
     '3': array([-1.09539267e+00,  2.60968085e-01,  5.00927803e-01,  2.59785422e-01,
            -1.45688877e+00, -5.51619874e-01,  5.00952447e-01, -1.54324720e+00,
             2.63882591e-01,  1.06427574e+00, -1.12790731e+00,  2.42748950e-01,
             9.60257758e-01, -1.60495021e-01, -9.50924950e-02,  1.26040902e+00,
            -2.20454335e+00, -1.81916931e+00,  6.33262822e-01, -1.26715068e+00,
            -3.43546718e-02, -8.21153084e-01,  7.58428315e-01, -2.37389045e-01,
            -1.21173260e+00,  1.17995836e-01,  1.25396453e+00,  1.15726648e+00,
             2.43550886e-02,  1.42813371e+00,  2.56026295e-02, -6.01327326e-01,
             2.19539920e-02,  1.49726186e+00,  3.52038518e-01,  1.79008408e-01,
            -3.03215614e-01,  8.04015835e-01, -1.01245930e+00, -1.31986170e+00,
            -9.66992618e-01,  3.18322610e-01,  4.49785251e-01,  1.77318168e-01,
             2.91012156e-01,  1.17007942e+00, -1.63570659e-01, -7.78658837e-01,
            -4.36798803e-01, -9.46413316e-01, -9.14871582e-01,  3.13780280e-01,
             6.42762368e-01, -8.98938739e-01,  6.66392826e-01,  6.86871415e-03,
            -1.12850143e-01,  9.18944143e-02, -7.02796184e-01,  4.13226540e-01,
            -2.19004429e-01, -1.06946305e+00, -9.82612278e-01,  2.80119602e-01,
             6.06676909e-02, -4.73282775e-01,  1.82215340e-01, -2.16341103e+00,
            -7.45163973e-01, -7.85111448e-01,  2.21158149e-01, -1.07061842e-01,
            -3.14655563e+00,  1.44545854e+00,  5.48771044e-01,  1.38563747e+00,
             1.88384555e-01,  1.68935109e-01,  1.28736699e-01, -1.08080053e+00,
             4.50396775e-02,  1.03072365e+00,  2.86830748e-01, -1.01476213e+00,
             9.74045414e-01,  2.30225304e+00, -5.95571941e-01, -6.89702175e-01,
             1.21428004e+00, -5.40238353e-01, -6.66993303e-01,  4.08615796e-01,
            -1.22101521e+00, -6.70733922e-01, -1.19542366e-01, -1.75134238e-02,
             9.53580211e-01, -7.72898655e-01, -2.12973074e-01,  2.03125444e-01,
             1.75893973e-01, -1.21384718e+00,  2.15690522e-01, -1.25661139e+00,
            -3.71397667e-01,  5.69763616e-02,  8.54743016e-01,  2.19936850e+00,
             9.60382732e-04,  6.71453387e-01,  5.09508643e-01,  2.44017766e-01,
            -1.25595104e-01,  2.48193581e-01,  2.02198831e+00, -1.33816994e+00,
            -7.19293543e-01,  1.98853300e+00,  1.63640877e+00,  5.08201711e-01,
            -1.02488543e+00,  5.89232200e-01, -7.46731825e-01,  7.02215650e-01,
             3.20602116e-01, -1.43715969e+00, -3.13337721e-01,  5.49998653e-01,
             8.01405338e-01, -4.45101874e-01,  2.36919446e+00,  8.73790221e-01,
             2.87424829e-01, -7.98376841e-01,  1.09016323e+00,  6.66231709e-01,
            -3.39148334e-01,  3.01588583e+00,  8.80450394e-01,  7.53531244e-01,
            -1.14185541e+00,  3.63547213e-01, -1.21833913e+00,  1.38787447e+00,
             4.58418862e-01,  1.06846453e+00, -2.61947773e-01, -8.61389862e-01,
            -8.33836994e-03, -1.73704474e-01,  1.77655600e+00,  1.55540077e+00,
             9.36476531e-01, -1.30042365e+00, -1.10903603e-01, -1.00725121e+00,
             1.00314322e+00,  1.45188287e+00, -1.48599095e+00, -1.71905026e-01,
            -8.88029881e-01,  3.41503866e-01, -5.16020126e-02, -2.36569552e+00,
            -4.20003922e-01, -8.42504687e-01,  1.00432919e+00, -5.63221075e-01,
            -1.04808627e+00,  1.00079964e+00,  1.89416526e-02,  6.61018961e-01,
            -4.21560576e-01, -2.42153595e-01,  4.81207211e-01, -2.34802503e-01,
             7.47192082e-01, -4.71012619e-01,  1.17128373e+00, -7.17141225e-01,
            -1.67022197e+00,  3.99733461e-01, -4.37601941e-01, -1.41181098e-01,
             9.28888554e-01,  8.70460814e-01,  2.00780780e+00, -2.84657909e+00,
             6.01786668e-01, -1.94391137e+00, -1.26182271e-01,  6.84521315e-01,
            -4.14644495e-01,  7.22410222e-01,  1.58459647e+00,  1.52859285e-01,
             3.35066300e-01,  1.01629320e+00, -9.36513493e-01,  2.50138163e-01,
             2.82064004e-01,  1.10860586e+00,  1.05240361e+00, -1.33235710e+00,
             1.45533823e+00, -4.57208361e-02,  7.44948170e-01, -9.75309466e-01,
            -4.64844679e-02, -5.26999610e-01,  2.69162766e-01, -9.84166293e-01,
             1.83852584e+00, -5.06727087e-01,  1.12494274e+00, -8.24229979e-01,
             1.82048459e-01,  6.61696445e-01,  1.90563176e-01,  9.03674154e-02,
             4.96286053e-01,  2.08159263e+00, -3.69838564e-01,  1.32781201e+00,
            -2.81082046e-01,  9.60767096e-01, -1.28585660e+00, -8.22914956e-01,
             4.11083957e-01, -3.70276004e-01, -7.56792129e-01,  1.76683257e+00,
            -4.16801501e-01, -1.41800783e-01,  1.29083704e-01,  5.59104061e-01,
            -1.24247185e+00,  3.97883052e-01,  9.82167078e-01,  5.01984993e-01,
            -4.70937672e-03, -7.72246271e-01, -6.67415351e-01,  2.90672931e-01,
             1.15904734e+00,  5.68249466e-01, -7.34026198e-02, -5.30384488e-02,
             1.17166238e+00,  3.53639669e-01, -1.62870055e-01,  5.43233255e-01,
            -1.63675354e-01, -4.27806671e-01,  3.52271461e-02,  1.52577837e+00,
             5.35469260e-02,  8.58688267e-01, -2.12022681e-01, -1.23232740e+00,
             1.68921228e-01,  8.86688853e-01,  3.43090654e-01, -1.46723958e+00,
            -1.21903093e+00, -8.85487206e-01,  1.01193275e+00, -7.40804671e-02,
            -4.06895400e-01, -4.83003554e-01,  1.16438604e+00, -1.57024521e+00,
            -7.16575150e-01,  1.75940696e-01, -5.51156869e-01, -1.13748783e+00,
            -2.17655786e-01,  1.27849645e+00, -1.34532908e+00, -1.27529055e+00,
            -5.94155356e-01,  4.71128941e-01,  1.92600840e+00, -5.75669933e-01,
            -7.29347291e-02, -1.40010210e-01,  7.90377266e-01, -1.91497996e-01,
            -8.59613507e-01, -1.44138164e+00, -1.58616843e+00, -8.94022546e-01,
            -1.23217639e-01,  4.68097781e-01,  1.08876559e-01,  5.60560359e-01,
             7.13194195e-01, -3.34851371e-01, -9.09862595e-01,  1.60784764e+00,
            -5.25281323e-01, -1.28337733e+00,  9.37048286e-01,  1.41897937e-01,
            -5.42963879e-01,  4.32703886e-01,  6.61839672e-02, -1.06556361e-01,
             4.19518019e-01, -6.05709336e-01,  2.24154620e-01, -6.46092969e-01,
            -6.89993532e-01,  7.07400208e-01, -3.32413569e-01,  2.51778658e-01,
            -1.88366610e+00, -3.77257616e-01,  9.91267127e-01,  7.26647965e-01,
             6.80491945e-01,  4.73774429e-01,  1.03658827e+00,  6.57389887e-01,
             8.11546143e-01,  9.66007321e-01, -3.57010377e-01,  5.10691703e-01,
             2.93526482e-01, -1.44828426e+00, -4.76246756e-01, -1.08696719e-01,
             5.07616808e-01,  6.78752977e-02,  2.37985919e-01, -1.36685637e+00,
             7.14028166e-01, -1.66745245e+00,  4.42532632e-01, -2.54358797e-01,
             1.11785819e+00,  4.14675884e-01,  9.85420082e-01, -1.01639583e+00,
            -4.79617806e-01, -1.12410252e-01,  2.19277076e+00, -3.20893187e-01,
             6.76089284e-01, -8.63991273e-01, -1.06706778e+00, -6.98562053e-01,
            -5.28472385e-01,  1.02539965e+00, -8.94254454e-01,  5.14054397e-01,
            -1.08503143e+00, -2.43884950e+00, -7.77113271e-01, -1.12563783e+00,
            -6.08475352e-01,  1.29504597e+00, -1.19199650e+00,  7.75031409e-01,
            -1.47527748e+00])}




```python
W = {str(scen): b[str(scen)].cumsum() for scen in range(1, esc + 1)}
W
```




    {'1': array([ -0.78872559,  -2.24706865,  -3.33770341,  -3.88900805,
             -4.28895189,  -3.7392997 ,  -3.14770664,  -3.02935883,
             -2.94429987,  -2.66832485,  -2.55684938,  -4.02067856,
             -6.04582189,  -4.24420068,  -3.42847335,  -3.69498693,
             -3.51240803,  -5.24216677,  -5.58898858,  -5.63486184,
             -7.17747605,  -8.94131898,  -9.28849192,  -8.92300581,
             -8.00918408,  -7.10971573,  -7.59383659,  -7.70474202,
             -8.76483458,  -9.23358504, -10.13023705,  -9.06579284,
             -9.64563868,  -9.94737096, -10.85735287,  -9.3839634 ,
             -8.84764237, -10.04782683,  -9.48229109,  -8.50623975,
             -7.17354442,  -7.12818477,  -7.49305521,  -7.62767339,
             -6.5228217 ,  -5.62760272,  -6.61185387,  -6.63879657,
             -4.59947471,  -3.26855784,  -3.8983599 ,  -4.01071962,
             -3.75623583,  -3.91375163,  -3.34914302,  -2.31386779,
             -3.19359374,  -3.00600246,  -4.62438411,  -6.0595079 ,
             -7.16893386,  -7.0816926 ,  -6.81298453,  -6.09337473,
             -5.30727991,  -4.80264976,  -4.36543011,  -4.46411415,
             -3.3983604 ,  -2.59675219,  -3.65981707,  -4.71295729,
             -4.98909016,  -5.04766462,  -4.79564034,  -7.37194765,
             -7.04404987,  -7.50370686,  -8.32034098,  -7.93241768,
             -6.96614093,  -7.45914573,  -7.23498886,  -7.66439262,
             -6.56830694,  -6.78609046,  -7.34133751,  -7.47088212,
             -7.30161823,  -6.69692379,  -9.02629465,  -9.37393483,
             -7.83450022,  -7.22564873,  -7.40839172,  -6.2665476 ,
             -7.20083685,  -6.48822614,  -5.33145368,  -3.46959423,
             -3.70456105,  -4.12136548,  -3.01356664,  -3.47539058,
             -2.78722334,  -3.18213378,  -4.13315674,  -4.63846459,
             -5.31457005,  -4.42910083,  -5.00287836,  -3.17366358,
             -3.39164436,  -2.61019149,  -2.17671754,  -2.82759765,
             -2.81329903,  -5.21915412,  -4.31792818,  -2.55405676,
             -2.6143305 ,  -4.01399495,  -3.52682206,  -1.85530698,
             -3.59790462,  -1.9877066 ,  -1.81765269,  -3.13065269,
             -2.70895243,   0.51096893,   2.28794109,   3.08807162,
              4.2193828 ,   4.16239364,   3.81730111,   3.88199836,
              3.90409992,   1.99249144,   1.61764447,   1.78273661,
              0.78555946,   0.94655997,   2.41607069,   2.79024961,
              2.86682833,   1.13906472,  -0.38494917,   0.31595647,
             -0.22440614,  -1.50100092,  -0.85852506,  -0.86651216,
             -1.03666336,  -2.85402208,  -2.10652938,  -2.18422337,
             -1.63010468,   0.03619179,  -0.24629947,  -0.99182443,
             -0.32533796,  -0.91311184,  -0.56549523,  -1.98196922,
             -2.74835683,  -2.27098342,  -2.0972869 ,  -1.22555349,
             -2.14445308,  -2.57823179,  -2.3248685 ,  -3.73011371,
             -2.41114402,  -2.20079847,  -3.38545203,  -3.5709222 ,
             -2.45189776,  -2.2464336 ,  -3.84307455,  -4.81119627,
             -4.19152425,  -4.89328448,  -5.48166556,  -4.20051533,
             -3.32413468,  -2.90865279,  -1.88872699,  -1.78906992,
             -2.29674585,  -2.61487768,  -1.39585812,  -1.44897745,
             -0.23947983,   0.93694811,   3.00959746,   1.40413717,
             -0.11914875,  -0.11812522,  -0.64643371,  -0.8514174 ,
             -1.55848554,  -3.73616725,  -3.35814588,  -1.15390072,
             -1.26041323,  -0.27578179,   1.05020341,   0.61020251,
             -0.53536543,  -1.86705948,  -1.95242379,  -1.39975183,
             -1.78909539,  -1.67577323,  -2.66130578,  -2.80827604,
             -2.20336311,  -2.81833754,  -3.3376169 ,  -4.07681635,
             -4.68581932,  -4.09117963,  -3.23660944,  -4.20381165,
             -4.90384688,  -4.45511241,  -3.98152412,  -2.95203905,
             -3.47484543,  -2.4717195 ,  -2.29219722,  -2.52929479,
             -2.6839367 ,  -1.18927001,  -1.1779919 ,  -0.37995592,
              0.24218739,   0.17843451,  -1.26279309,  -0.74409517,
              0.7695439 ,   0.07110067,   0.79067816,   3.67624127,
              5.1975768 ,   5.04091476,   6.13817303,   6.29152705,
              5.97849604,   7.37701354,   6.65948607,   7.63416816,
              8.27762766,   7.25056055,   7.23800582,   8.01100671,
              8.14481819,   8.06854987,   8.51054283,   7.66645161,
              7.33604955,   7.48627787,   8.49158794,   7.85208818,
              7.43202421,   8.3915701 ,   8.22991954,   7.97175088,
              8.47315505,   9.94764993,  10.54972296,  10.66446775,
             10.4942925 ,   8.27209518,   8.24299482,   6.4787155 ,
              5.56931172,   4.9642142 ,   5.27736893,   5.20265306,
              3.79194023,   4.19973802,   3.90013055,   3.66275313,
              5.40110313,   7.46459849,   6.39738555,   5.37190329,
              4.63982536,   3.89259375,   2.18016953,   0.4764022 ,
             -0.18526738,   0.13605994,   0.92349676,   0.28581231,
             -0.05064404,   0.01629942,   0.80279248,   0.09080654,
              0.30054122,   1.00337961,   0.59055413,   2.01265699,
              2.54607646,   3.42802184,   2.45450783,   0.90651373,
              1.9949439 ,   1.00872606,  -0.19041639,  -1.4574011 ,
             -2.21098706,  -1.96859204,  -2.13049464,  -1.78133022,
             -1.99114541,  -1.15304052,  -1.34342707,  -1.6091434 ,
             -2.41931775,  -1.4419017 ,  -1.48454468,  -1.10533569,
             -2.98385201,  -3.95413747,  -3.20293726,  -1.87123221,
             -2.16833697,  -0.57097223,   0.6951898 ,   0.25423404,
             -0.493939  ,  -0.44875454,  -0.59941601,  -0.08915363,
              0.80539683,   0.74853446,   1.41551319,   2.61515368,
              2.91012153,   3.72294707,   3.86415479,   4.39182783,
              4.55253677,   6.18528532,   6.54158469,   6.10982868,
              6.43396585,   4.80777148,   3.65890145,   4.43667693,
              3.51941629,   2.69103159,   2.28838679,   1.84815091,
              2.72069962,   2.41117665,   1.27789668,  -0.16483868,
              1.45677121,  -1.10013513,  -1.71441111,  -2.32516514,
             -1.8275933 ]),
     '2': array([  0.50719888,  -1.01446199,  -0.6586681 ,  -0.77274444,
             -0.46665801,   0.28379608,   1.36837893,   1.37028581,
              0.87252807,   2.12291427,   1.26623006,   1.21223176,
             -0.24225681,  -1.73252203,  -2.35392404,  -2.71482088,
             -4.64792798,  -4.10004195,  -3.01267217,  -3.95796155,
             -3.29438035,  -1.74283169,  -2.42609746,  -2.7668968 ,
             -3.36173769,  -2.77500524,  -2.02003238,  -3.78909661,
             -1.7538251 ,  -2.86837661,  -3.111707  ,  -5.2872309 ,
             -7.22081305,  -6.80083227,  -5.87593922,  -7.00634436,
             -7.72286851,  -7.0453325 ,  -5.82474701,  -6.4274907 ,
             -5.86675902,  -5.78611302,  -5.98345632,  -4.8841098 ,
             -5.13474838,  -4.71782338,  -4.32241688,  -4.5409135 ,
             -4.80047861,  -4.04280074,  -4.36643786,  -5.11598055,
             -3.35493557,  -3.01595142,  -4.10717344,  -2.97643649,
             -2.82306435,  -1.1359205 ,  -2.58974022,  -3.68768432,
             -4.59178059,  -4.32233908,  -3.58081832,  -2.76371455,
             -2.79232729,  -2.33459167,  -2.96881157,  -2.77253505,
             -3.42001746,  -6.34611776,  -6.80088399,  -7.00478763,
             -7.12653703,  -5.96813763,  -6.42768541,  -5.91833006,
             -5.97791846,  -8.38995639,  -8.05740866,  -5.73879871,
             -6.74474266,  -6.30149396,  -5.65044221,  -6.05344611,
             -7.30910661,  -7.0239163 ,  -7.88065939,  -8.4660097 ,
             -9.24963756,  -9.33884209,  -9.42978085,  -8.59523603,
            -10.2090514 , -10.03971072, -10.33322705,  -9.60983812,
             -9.52130885, -10.7956176 , -10.40922812, -11.23367276,
            -10.70862989, -10.29622804, -10.00062964,  -8.90101375,
             -9.10484108,  -9.36308416,  -9.03655957, -11.17405312,
             -9.55693765,  -9.86524563, -12.17877493, -12.63276315,
            -12.6748438 , -13.79222127, -15.04606732, -14.66896536,
            -16.0110485 , -16.30386006, -15.97288055, -14.69243209,
            -14.72183804, -14.83071295, -15.35412755, -16.89271839,
            -18.14977633, -17.07099279, -17.12723693, -17.94651579,
            -17.91243015, -18.67009921, -18.40916202, -18.41188733,
            -17.66298724, -18.1605115 , -17.75595495, -17.76950936,
            -18.31314071, -18.75317079, -20.36096424, -20.03996353,
            -19.95868907, -21.21942135, -23.4182328 , -23.4409614 ,
            -24.98525283, -24.63629426, -24.2219558 , -22.75992291,
            -22.94597233, -23.77135771, -22.64956841, -23.53561932,
            -24.22795679, -25.3926025 , -26.09743203, -25.83157307,
            -26.50330577, -25.44005793, -26.21878036, -26.43076595,
            -27.00092726, -25.63942145, -26.74700187, -24.88554451,
            -25.60877665, -25.10394039, -24.74609994, -24.98960621,
            -24.00952794, -22.97554371, -21.78278415, -22.41833055,
            -20.97957453, -19.00349808, -17.9493553 , -16.80919707,
            -17.29385138, -16.42391429, -16.60275952, -14.66690311,
            -13.72956546, -13.26323574, -12.6685891 , -12.94298871,
            -11.88049208, -13.67440476, -13.58913743, -13.76610771,
            -12.88284399, -14.67967748, -15.65171217, -17.5648268 ,
            -17.02560572, -18.11399424, -19.14483734, -17.06334726,
            -16.64319738, -16.09757519, -13.95751385, -14.77413814,
            -14.59302829, -14.3558503 , -15.36234063, -14.27883073,
            -15.02058261, -15.72901529, -16.62819748, -16.49675365,
            -18.2469203 , -18.5777833 , -17.73272124, -17.50947325,
            -15.25673781, -14.91349374, -15.26373324, -15.80921361,
            -14.85772023, -14.34411535, -14.10030253, -13.74875934,
            -13.98694862, -13.97474384, -14.41967728, -16.41753556,
            -17.2866969 , -16.92034391, -15.1950417 , -14.88041471,
            -15.09220621, -16.60312561, -16.83275931, -16.9391749 ,
            -16.90400773, -18.19995793, -17.76277724, -18.87110176,
            -19.36060362, -18.74015345, -19.89272894, -20.38517286,
            -21.3011053 , -21.14015697, -21.75747082, -22.33412379,
            -22.52163879, -22.83925182, -20.9464636 , -20.567805  ,
            -17.6518179 , -19.29342965, -19.54979378, -19.61368893,
            -20.25737439, -20.25919826, -20.57607279, -21.34755008,
            -22.24024918, -21.75741469, -22.10617118, -22.24016314,
            -24.0658032 , -25.17733246, -25.47207112, -24.87676134,
            -23.97106718, -24.2758645 , -24.14566494, -23.46048444,
            -22.25986537, -21.78281275, -22.44104845, -22.54436527,
            -23.58561032, -22.97444156, -22.69804427, -24.00245961,
            -23.26900231, -22.92228136, -22.14140109, -21.65781284,
            -20.72872343, -20.42929134, -20.49691935, -20.11186627,
            -19.79218916, -20.75711575, -21.33828687, -22.99207559,
            -23.65009397, -23.52446042, -23.84766584, -23.27863351,
            -24.23403746, -22.5244157 , -23.07358764, -21.79952638,
            -21.9395057 , -21.26102349, -21.33891579, -21.23728815,
            -21.65309365, -22.44404735, -22.29415983, -21.98506891,
            -21.57012547, -20.43559056, -22.01471231, -20.98877596,
            -20.23447284, -20.60485018, -20.26057554, -20.8261277 ,
            -22.22389112, -22.28596081, -22.80234677, -22.69001897,
            -22.24340313, -23.48989774, -24.55310746, -23.87368052,
            -24.00490893, -24.31449318, -23.22423401, -22.55878031,
            -22.22629202, -21.34282264, -20.84201448, -20.86995057,
            -19.7207085 , -19.74254157, -19.63057404, -21.44488436,
            -20.59528213, -22.05406865, -21.41542422, -21.33301949,
            -23.41827404, -22.67468797, -25.06696464, -24.21934228,
            -24.62318854, -24.78026609, -24.67263404, -24.57831985,
            -24.45429112, -24.11568442, -24.11729833, -25.06508544,
            -26.44157938, -25.51241354, -24.30893384, -24.44611578,
            -24.20947719, -25.93220423, -26.68703942, -27.72383717,
            -26.47322329, -27.68117455, -28.76690343, -30.62337417,
            -30.40916092, -30.33881462, -29.64027921, -29.49668347,
            -29.37479007]),
     '3': array([ -1.09539267,  -0.83442459,  -0.33349678,  -0.07371136,
             -1.53060013,  -2.08222001,  -1.58126756,  -3.12451477,
             -2.86063218,  -1.79635644,  -2.92426374,  -2.68151479,
             -1.72125703,  -1.88175206,  -1.97684455,  -0.71643554,
             -2.92097889,  -4.7401482 ,  -4.10688537,  -5.37403606,
             -5.40839073,  -6.22954381,  -5.4711155 ,  -5.70850454,
             -6.92023714,  -6.8022413 ,  -5.54827677,  -4.3910103 ,
             -4.36665521,  -2.9385215 ,  -2.91291887,  -3.5142462 ,
             -3.49229221,  -1.99503034,  -1.64299183,  -1.46398342,
             -1.76719903,  -0.9631832 ,  -1.9756425 ,  -3.2955042 ,
             -4.26249682,  -3.94417421,  -3.49438895,  -3.31707079,
             -3.02605863,  -1.85597921,  -2.01954987,  -2.79820871,
             -3.23500751,  -4.18142083,  -5.09629241,  -4.78251213,
             -4.13974976,  -5.0386885 ,  -4.37229567,  -4.36542696,
             -4.4782771 ,  -4.38638269,  -5.08917887,  -4.67595233,
             -4.89495676,  -5.96441981,  -6.94703209,  -6.66691249,
             -6.6062448 ,  -7.07952757,  -6.89731223,  -9.06072326,
             -9.80588723, -10.59099868, -10.36984053, -10.47690237,
            -13.623458  , -12.17799946, -11.62922841, -10.24359094,
            -10.05520639,  -9.88627128,  -9.75753458, -10.83833511,
            -10.79329544,  -9.76257178,  -9.47574104, -10.49050316,
             -9.51645775,  -7.21420471,  -7.80977665,  -8.49947883,
             -7.28519879,  -7.82543715,  -8.49243045,  -8.08381465,
             -9.30482987,  -9.97556379, -10.09510616, -10.11261958,
             -9.15903937,  -9.93193802, -10.1449111 ,  -9.94178565,
             -9.76589168, -10.97973886, -10.76404834, -12.02065973,
            -12.39205739, -12.33508103, -11.48033802,  -9.28096952,
             -9.28000913,  -8.60855575,  -8.0990471 ,  -7.85502934,
             -7.98062444,  -7.73243086,  -5.71044255,  -7.0486125 ,
             -7.76790604,  -5.77937304,  -4.14296427,  -3.63476256,
             -4.659648  ,  -4.0704158 ,  -4.81714762,  -4.11493197,
             -3.79432986,  -5.23148955,  -5.54482727,  -4.99482862,
             -4.19342328,  -4.63852515,  -2.2693307 ,  -1.39554048,
             -1.10811565,  -1.90649249,  -0.81632926,  -0.15009756,
             -0.48924589,   2.52663994,   3.40709033,   4.16062158,
              3.01876617,   3.38231338,   2.16397426,   3.55184872,
              4.01026758,   5.07873211,   4.81678434,   3.95539448,
              3.94705611,   3.77335163,   5.54990763,   7.1053084 ,
              8.04178493,   6.74136128,   6.63045768,   5.62320647,
              6.62634969,   8.07823255,   6.5922416 ,   6.42033658,
              5.53230669,   5.87381056,   5.82220855,   3.45651303,
              3.03650911,   2.19400442,   3.19833361,   2.63511253,
              1.58702626,   2.58782591,   2.60676756,   3.26778652,
              2.84622594,   2.60407235,   3.08527956,   2.85047706,
              3.59766914,   3.12665652,   4.29794025,   3.58079902,
              1.91057705,   2.31031052,   1.87270857,   1.73152748,
              2.66041603,   3.53087685,   5.53868464,   2.69210555,
              3.29389222,   1.34998085,   1.22379858,   1.9083199 ,
              1.4936754 ,   2.21608562,   3.80068209,   3.95354137,
              4.28860767,   5.30490088,   4.36838738,   4.61852554,
              4.90058955,   6.00919541,   7.06159902,   5.72924192,
              7.18458015,   7.13885932,   7.88380749,   6.90849802,
              6.86201356,   6.33501394,   6.60417671,   5.62001042,
              7.45853626,   6.95180917,   8.07675191,   7.25252193,
              7.43457039,   8.09626683,   8.28683001,   8.37719742,
              8.87348348,  10.95507611,  10.58523754,  11.91304955,
             11.63196751,  12.5927346 ,  11.306878  ,  10.48396305,
             10.895047  ,  10.524771  ,   9.76797887,  11.53481144,
             11.11800994,  10.97620916,  11.10529286,  11.66439692,
             10.42192507,  10.81980813,  11.8019752 ,  12.3039602 ,
             12.29925082,  11.52700455,  10.8595892 ,  11.15026213,
             12.30930947,  12.87755894,  12.80415632,  12.75111787,
             13.92278025,  14.27641992,  14.11354987,  14.65678312,
             14.49310777,  14.0653011 ,  14.10052824,  15.62630662,
             15.67985354,  16.53854181,  16.32651913,  15.09419173,
             15.26311296,  16.14980181,  16.49289247,  15.02565289,
             13.80662196,  12.92113475,  13.9330675 ,  13.85898703,
             13.45209163,  12.96908808,  14.13347412,  12.56322891,
             11.84665376,  12.02259445,  11.47143758,  10.33394976,
             10.11629397,  11.39479042,  10.04946133,   8.77417079,
              8.18001543,   8.65114437,  10.57715277,  10.00148284,
              9.92854811,   9.7885379 ,  10.57891517,  10.38741717,
              9.52780366,   8.08642203,   6.5002536 ,   5.60623105,
              5.48301341,   5.95111119,   6.05998775,   6.62054811,
              7.33374231,   6.99889093,   6.08902834,   7.69687598,
              7.17159466,   5.88821732,   6.82526561,   6.96716355,
              6.42419967,   6.85690355,   6.92308752,   6.81653116,
              7.23604918,   6.63033984,   6.85449446,   6.20840149,
              5.51840796,   6.22580817,   5.8933946 ,   6.14517326,
              4.26150716,   3.88424955,   4.87551667,   5.60216464,
              6.28265658,   6.75643101,   7.79301928,   8.45040916,
              9.26195531,  10.22796263,   9.87095225,  10.38164395,
             10.67517043,   9.22688618,   8.75063942,   8.6419427 ,
              9.14955951,   9.21743481,   9.45542073,   8.08856436,
              8.80259252,   7.13514008,   7.57767271,   7.32331391,
              8.4411721 ,   8.85584798,   9.84126806,   8.82487223,
              8.34525442,   8.23284417,  10.42561493,  10.10472174,
             10.78081102,   9.91681975,   8.84975197,   8.15118992,
              7.62271753,   8.64811718,   7.75386273,   8.26791712,
              7.18288569,   4.74403619,   3.96692292,   2.84128509,
              2.23280974,   3.52785571,   2.33585921,   3.11089062,
              1.63561314])}




```python
drift = (mu - 0.5 * sigma**2) * t
diffusion = {str(scen): sigma * W[str(scen)] for scen in range(1, esc + 1)}

```


```python

```


```python
S1 = np.array([so * np.exp(drift + diffusion[str(scen)]) for scen in range(1, esc + 1)]) 
S1 = np.hstack((np.array([[so] for scen in range(esc)]), S1))
```


```python
s2 = np.array(data['ULT'].values)[0]
s2
```




    195.0




```python
S2 = np.array([s2 * np.exp(drift + diffusion[str(scen)]) for scen in range(1, esc + 1)]) 
S2 = np.hstack((np.array([[s2] for scen in range(esc)]), S2))
```


```python
S1
```




    array([[418.        , 412.08847495, 401.18012274, ..., 499.46154908,
            494.0476132 , 498.97803319],
           [418.        , 422.24787884, 410.58174005, ..., 295.51408315,
            296.48432719, 297.33646199],
           [418.        , 409.72034469, 411.97328141, ..., 538.96348479,
            547.18794204, 532.53387937]])




```python
import datetime

ini = data['FECHA'].max()
fin = ini+datetime.timedelta(days=365)
```


```python
pd.date_range(start = ini, 
                end = fin, freq = 'D')
```




    DatetimeIndex(['2021-02-10', '2021-02-11', '2021-02-12', '2021-02-13',
                   '2021-02-14', '2021-02-15', '2021-02-16', '2021-02-17',
                   '2021-02-18', '2021-02-19',
                   ...
                   '2022-02-01', '2022-02-02', '2022-02-03', '2022-02-04',
                   '2022-02-05', '2022-02-06', '2022-02-07', '2022-02-08',
                   '2022-02-09', '2022-02-10'],
                  dtype='datetime64[ns]', length=366, freq='D')




```python
import matplotlib.pyplot as plt

plt.figure(figsize = (20,10))

for i in range(esc):
    plt.title("Daily Volatility: " + str(sigma))
    plt.plot(pd.date_range(start = ini, end = fin, freq = 'D'),S1[i,:])
    plt.ylabel('Stock Prices, â‚¬')
    plt.xlabel('Prediction Days')
    
plt.show()
```


![png](output_49_0.png)



```python
S1[2].mean()*3.5
```




    1740.5401426627777




```python
3.5*S1[1][0:30].mean()#Enero
```




    1439.0390812832575




```python
3.5*S1[1][31:60].mean()#Febrero
```




    1370.4887584767941




```python
3.5*S1[1][61:91].mean()#Marzo
```




    1368.4856737079847




```python
3.5*S1[1][92:122].mean()#Abril
```




    1252.7695700012675




```python
3.5*S1[1][123:153].mean()#Mayo
```




    1087.5739361926937




```python
3.5*S1[1][153:183].mean()#Junio
```




    1064.3221595642462




```python
3.5*S1[1][184:214].mean()#Julio
```




    1223.905593890728




```python
3.5*S1[1][215:245].mean()#Agosto
```




    1212.6219329754033




```python
3.5*S1[1][246:276].mean()#Septiembre
```




    1122.2524862089026




```python
3.5*S1[1][278:319].mean()#Octubre
```




    1153.2631800440795




```python
3.5*S1[1][320:350].mean()#Noviembre
```




    1155.0471985085228




```python
3.5*S1[1][351:365].mean()#Diciembre
```




    1071.68844353736




```python

```
